<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>SVEIRD compartmental model with optional Bayesian data assimilation — SVEIRD.BayesianDataAssimilation • spatialEpisim.foundation</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SVEIRD compartmental model with optional Bayesian data assimilation — SVEIRD.BayesianDataAssimilation"><meta name="description" content="Run a SVEIRD compartmental model of an epidemic, optionally using Bayesian data assimilation."><meta property="og:description" content="Run a SVEIRD compartmental model of an epidemic, optionally using Bayesian data assimilation."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spatialEpisim.foundation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Getting_Started.html">Getting_Started</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/krishnamurthylab/spatialepisim.foundation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SVEIRD compartmental model with optional Bayesian data assimilation</h1>
      <small class="dont-index">Source: <a href="https://github.com/krishnamurthylab/spatialepisim.foundation/blob/main/R/SVEIRD.BayesianDataAssimilation.R" class="external-link"><code>R/SVEIRD.BayesianDataAssimilation.R</code></a></small>
      <div class="d-none name"><code>SVEIRD.BayesianDataAssimilation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run a SVEIRD compartmental model of an epidemic, optionally using Bayesian data assimilation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SVEIRD.BayesianDataAssimilation</span><span class="op">(</span></span>
<span>  <span class="va">alpha</span>,</span>
<span>  <span class="va">beta</span>,</span>
<span>  <span class="va">gamma</span>,</span>
<span>  <span class="va">sigma</span>,</span>
<span>  <span class="va">delta</span>,</span>
<span>  <span class="va">n.days</span>,</span>
<span>  <span class="va">seedData</span>,</span>
<span>  neighbourhood.order <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">populationSpatRaster</span>,</span>
<span>  <span class="va">subregionsSpatVector</span>,</span>
<span>  <span class="va">aggregationFactor</span>,</span>
<span>  <span class="va">startDate</span>,</span>
<span>  <span class="va">countryCodeISO3C</span>,</span>
<span>  <span class="va">incidenceData</span>,</span>
<span>  <span class="va">deathData</span>,</span>
<span>  simulationIsDeterministic <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dataAssimilationEnabled <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">healthZoneCoordinates</span>,</span>
<span>  <span class="va">variableCovarianceFunction</span>,</span>
<span>  <span class="va">forecastError.cov.sdBackground</span>,</span>
<span>  <span class="va">forecastError.cor.length</span>,</span>
<span>  <span class="va">neighbourhood.Bayes</span>,</span>
<span>  <span class="va">psi.diagonal</span>,</span>
<span>  <span class="va">callback</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The rate of vaccination (per day)</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>The rate of exposure (per day)</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>The rate of becoming infectious (per day)</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>The rate of recovery (per day)</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>The fatality rate (per day)</p></dd>


<dt id="arg-n-days">n.days<a class="anchor" aria-label="anchor" href="#arg-n-days"></a></dt>
<dd><p>The number of days the simulation will run for, beginning from
the startDate.</p></dd>


<dt id="arg-seeddata">seedData<a class="anchor" aria-label="anchor" href="#arg-seeddata"></a></dt>
<dd><p>a dataframe, as described in <a href="initialInfections.fourCities.html">initialInfections.fourCities</a>.</p></dd>


<dt id="arg-neighbourhood-order">neighbourhood.order<a class="anchor" aria-label="anchor" href="#arg-neighbourhood-order"></a></dt>
<dd><p>The order of the queen's neighbourhood over which
to distribute the Exposed and Infected intial state variable; zero is no
neighbourhood, and corresponds to only the same cell where the queen
already is. Higher orders follow the simple formula <code>(2 * x + 1)^2</code> to
determine the number of cells over which to evenly disperse the exposed
and infected state variables. All other state variables are placed
directly in the grid cell corresponding to the health zone. At the moment
orders higher than one are prohibited, so the only valid values for this
argument are zero and one.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>the average dialy movement distance of an individual (in
kilometers).</p></dd>


<dt id="arg-populationspatraster">populationSpatRaster<a class="anchor" aria-label="anchor" href="#arg-populationspatraster"></a></dt>
<dd><p>a SpatRaster of population count data; it must
be pre-aggregated if any aggregation is to be used during the simulation;
none is performed by this function or downstream functions in the overall
implementation of SVEIRD.BayesianDataAssimilation simulations.</p></dd>


<dt id="arg-subregionsspatvector">subregionsSpatVector<a class="anchor" aria-label="anchor" href="#arg-subregionsspatvector"></a></dt>
<dd><p>a SpatVector object of subregions used to crop
the population SpatRaster before creating the other layers in the raster
object to represent the other compartments in a SVEIRD epidemic model. If
it is missing no cropping is performed.</p></dd>


<dt id="arg-aggregationfactor">aggregationFactor<a class="anchor" aria-label="anchor" href="#arg-aggregationfactor"></a></dt>
<dd><p>The number of adjacent cells in any one direction to
aggregate into a single cell. The aggregation factor must be the same as
that used to generate the SpatRaster for layers.</p></dd>


<dt id="arg-startdate">startDate<a class="anchor" aria-label="anchor" href="#arg-startdate"></a></dt>
<dd><p>The date (in YYYY-MM-DD format) the simulation begins.</p></dd>


<dt id="arg-countrycodeiso-c">countryCodeISO3C<a class="anchor" aria-label="anchor" href="#arg-countrycodeiso-c"></a></dt>
<dd><p>The ISO three character code for a recognized country.</p></dd>


<dt id="arg-incidencedata">incidenceData<a class="anchor" aria-label="anchor" href="#arg-incidencedata"></a></dt>
<dd><p>A "situation report" dataframe. The first column
provides the date of the officially reported, observed incidence of the
disease, in YYYY-MM-DD format.</p>
<div class="sourceCode"><pre><code>
    Date    Beni  Biena  Butembo  Goma  Kalunguta
    05-Aug  3     0      2        0     0
    12-Aug  2     0      0        0     0
    20-Aug  1     0      0        0     0
    26-Aug  5     0      0        0     0
    02-Sep  8     0      0        0     1
    09-Sep  5     0      2        0     0
    16-Sep  5     0      3        0     0
    23-Sep  4     0      1        0     0
    02-Oct  10    0      1        0     0
    07-Oct  14    0      4        0     0
    15-Oct  28    0      2        0     1
    21-Oct  19    0      3        0     0
    28-Oct  28    0      8        0     0
    04-Nov  16    0      6        0     1
    11-Nov  14    0      0        0     21
  </code></pre></div></dd>


<dt id="arg-deathdata">deathData<a class="anchor" aria-label="anchor" href="#arg-deathdata"></a></dt>
<dd><p>Data of the same format as incidenceData, but observations
represent deaths, not infections.</p></dd>


<dt id="arg-simulationisdeterministic">simulationIsDeterministic<a class="anchor" aria-label="anchor" href="#arg-simulationisdeterministic"></a></dt>
<dd><p>Whether stochasticity is enabled or not; if
the simulation is deterministic then no stochastic processes are used and
the simulation is entirely deterministic. Either <code>TRUE</code> or <code>FALSE</code>.</p></dd>


<dt id="arg-dataassimilationenabled">dataAssimilationEnabled<a class="anchor" aria-label="anchor" href="#arg-dataassimilationenabled"></a></dt>
<dd><p>Whether Bayesian data assimilation will be
used for state reporting data.</p></dd>


<dt id="arg-healthzonecoordinates">healthZoneCoordinates<a class="anchor" aria-label="anchor" href="#arg-healthzonecoordinates"></a></dt>
<dd><p>The coordinates of health zones in the country
of interest, TODO: describe the use of the data so users understand why
they must include it; e.g. (which will be used to group and summarize the
compartmental model data at the end of the simmulation.)</p>
<div class="sourceCode"><pre><code>
    HealthZone    Latitude    Longitude
    Alimbongo     -0.365515   29.1911818
    Beni          0.49113     29.47306
    Biena         0.57923     29.115633
    Butembo       0.140692    29.335014
    Goma          -1.658271   29.220132
    Kalunguta     0.323085    29.354677
    Katwa         0.116985    29.411838
    Kayna         -0.603936   29.174066
    Kyondo        -0.005622   29.408813
    Lubero        -0.15633    29.24057
    Mabalako      0.461257    29.210687
    Manguredjipa  0.353433    28.765479
    Masereka      -0.133333   29.333333
    Musienene     0.04022     29.26246
    Mutwanga      0.32893     29.74576
    Nyiragongo    -1.516667   29.25
    Oicha         0.698681    29.518834
    Pinga         -0.9830504  28.687911
    Vuhovi        0.1416      29.4075
    Ariwara       3.136873    30.706615
    Bunia         1.566667    30.25
    Komanda       1.367496    29.774322
    Lolwa         1.352969    29.498455
    Mambasa       1.359731    29.029226
    Mandima       1.35551     29.08173
    Nyakunde      1.431271    30.029283
    Rwampara      1.4053      30.3449
    Tchomia       1.4412      30.4845
  </code></pre></div></dd>


<dt id="arg-variablecovariancefunction">variableCovarianceFunction<a class="anchor" aria-label="anchor" href="#arg-variablecovariancefunction"></a></dt>
<dd><p>Passed directly to <code><a href="forecastError.cov.html">forecastError.cov()</a></code> to generate a
forecastErrorCovariance matrix.</p></dd>


<dt id="arg-forecasterror-cov-sdbackground">forecastError.cov.sdBackground<a class="anchor" aria-label="anchor" href="#arg-forecasterror-cov-sdbackground"></a></dt>
<dd><p>the "background" or default amount of error, in standard deviations.</p></dd>


<dt id="arg-forecasterror-cor-length">forecastError.cor.length<a class="anchor" aria-label="anchor" href="#arg-forecasterror-cor-length"></a></dt>
<dd><p>TODO</p></dd>


<dt id="arg-neighbourhood-bayes">neighbourhood.Bayes<a class="anchor" aria-label="anchor" href="#arg-neighbourhood-bayes"></a></dt>
<dd><p>The neighbourhood used in Bayesian data
assimilation; this is different from that used in the casting of seed data
about a neighbourhood of cells.</p></dd>


<dt id="arg-psi-diagonal">psi.diagonal<a class="anchor" aria-label="anchor" href="#arg-psi-diagonal"></a></dt>
<dd><p>A replacement value for elements of the Psi matrix'
diagonal which are zero.</p></dd>


<dt id="arg-callback">callback<a class="anchor" aria-label="anchor" href="#arg-callback"></a></dt>
<dd><p>a callback function to run, with no arguments, which will be
called every time the main loop of the simulation iterates, or a list of
callback functions which run before, during, and after the loop, and which
have the following structure. For each component, if the component is a
list it must have members fun and args, where fun is a function symbol and
args is a list of named arguments to the function; if it is not a list,
the component of the list (before, during, or after) must be a function.
See the examples.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list with components table, a tibble, and timeseries, a
SpatRasterDataset representing timeseries of different variables.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Bryce Carson</p>
<p>Ashok Krishnmaurthy</p>
<p>Michael Myer</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">IturiNordKivu</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>    <span class="co">## COD: Nord-Kivu and Ituri (Democratic Republic of Congo)</span></span></span>
<span class="r-in"><span>    <span class="st">"subregionsSpatVector"</span>,</span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"spatialEpisim.foundation"</span>,</span></span>
<span class="r-in"><span>    mustWork <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">populationDemocraticRepublicCongo</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"extdata"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"susceptibleSpatRaster.tif"</span>, <span class="co"># Congo population</span></span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"spatialEpisim.foundation"</span>,</span></span>
<span class="r-in"><span>    mustWork <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"healthZonesCongo"</span>, package <span class="op">=</span> <span class="st">"spatialEpisim.foundation"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"initialInfections.fourCities"</span>, package <span class="op">=</span> <span class="st">"spatialEpisim.foundation"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Congo.EbolaIncidence"</span>, package <span class="op">=</span> <span class="st">"spatialEpisim.foundation"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rasterAggregationFactor</span> <span class="op">=</span> <span class="fl">9</span></span></span>
<span class="r-in"><span><span class="va">simulation.days</span> <span class="op">&lt;-</span> <span class="fl">31</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cli"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">callback</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu">cli</span><span class="fu">::</span><span class="va"><a href="https://cli.r-lib.org/reference/cli_progress_bar.html" class="external-link">cli_progress_bar</a></span>,</span></span>
<span class="r-in"><span>                                 args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Simulating epidemic (SEI-type)"</span>,</span></span>
<span class="r-in"><span>                                             total <span class="op">=</span> <span class="va">simulation.days</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   during <span class="op">=</span> <span class="fu">cli</span><span class="fu">::</span><span class="va"><a href="https://cli.r-lib.org/reference/cli_progress_bar.html" class="external-link">cli_progress_update</a></span>,</span></span>
<span class="r-in"><span>                   after <span class="op">=</span> <span class="fu">cli</span><span class="fu">::</span><span class="va"><a href="https://cli.r-lib.org/reference/cli_progress_bar.html" class="external-link">cli_progress_done</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">callback</span> <span class="op">&lt;-</span> <span class="st">"{"</span> <span class="co"># does nothing</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">SVEIRD.BayesianDataAssimilation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="co">## Parameters</span></span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">3.5e-5</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="fl">7e-3</span>,</span></span>
<span class="r-in"><span>  gamma <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>  sigma <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">36</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">36</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="fl">18</span>,</span></span>
<span class="r-in"><span>  <span class="co">## Model runtime</span></span></span>
<span class="r-in"><span>  n.days <span class="op">=</span> <span class="va">simulation.days</span>,</span></span>
<span class="r-in"><span>  <span class="co">## Model data</span></span></span>
<span class="r-in"><span>  seedData <span class="op">=</span> <span class="va">initialInfections.fourCities</span>,</span></span>
<span class="r-in"><span>  neighbourhood.order <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  populationSpatRaster <span class="op">=</span> <span class="va">populationDemocraticRepublicCongo</span>,</span></span>
<span class="r-in"><span>  subregionsSpatVector <span class="op">=</span> <span class="va">IturiNordKivu</span>,</span></span>
<span class="r-in"><span>  aggregationFactor <span class="op">=</span> <span class="va">rasterAggregationFactor</span>,</span></span>
<span class="r-in"><span>  startDate <span class="op">=</span> <span class="st">"2018-08-01"</span>,</span></span>
<span class="r-in"><span>  countryCodeISO3C <span class="op">=</span> <span class="st">"COD"</span>,</span></span>
<span class="r-in"><span>  <span class="co">## Model options</span></span></span>
<span class="r-in"><span>  simulationIsDeterministic <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  dataAssimilationEnabled <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  callback <span class="op">=</span> <span class="va">callback</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in SVEIRD.BayesianDataAssimilation(alpha = 3.5e-05, beta = 0.007,     gamma = 1/7, sigma = 1/36, delta = 2/36, lambda = 18, n.days = simulation.days,     seedData = initialInfections.fourCities, neighbourhood.order = 1,     populationSpatRaster = populationDemocraticRepublicCongo,     subregionsSpatVector = IturiNordKivu, aggregationFactor = rasterAggregationFactor,     startDate = "2018-08-01", countryCodeISO3C = "COD", simulationIsDeterministic = TRUE,     dataAssimilationEnabled = FALSE, callback = callback):</span> object 'radius' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A large, lengthy simulation with Bayesian data assimilation (runtime</span></span></span>
<span class="r-in"><span><span class="co">## approximately four minutes).</span></span></span>
<span class="r-in"><span><span class="va">simulation.days</span> <span class="op">&lt;-</span> <span class="fl">28</span></span></span>
<span class="r-in"><span><span class="fu">SVEIRD.BayesianDataAssimilation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="co">## Parameters</span></span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">3.5e-5</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="fl">7e-3</span>,</span></span>
<span class="r-in"><span>  gamma <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">7</span>,</span></span>
<span class="r-in"><span>  sigma <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">36</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">36</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="fl">18</span>,</span></span>
<span class="r-in"><span>  <span class="co">## Model runtime</span></span></span>
<span class="r-in"><span>  n.days <span class="op">=</span> <span class="va">simulation.days</span>,</span></span>
<span class="r-in"><span>  <span class="co">## Model data</span></span></span>
<span class="r-in"><span>  seedData <span class="op">=</span> <span class="va">initialInfections.fourCities</span>,</span></span>
<span class="r-in"><span>  neighbourhood.order <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  populationSpatRaster <span class="op">=</span> <span class="va">populationDemocraticRepublicCongo</span>,</span></span>
<span class="r-in"><span>  aggregationFactor <span class="op">=</span> <span class="va">rasterAggregationFactor</span>,</span></span>
<span class="r-in"><span>  subregionsSpatVector <span class="op">=</span> <span class="va">IturiNordKivu</span>,</span></span>
<span class="r-in"><span>  startDate <span class="op">=</span> <span class="st">"2018-08-01"</span>,</span></span>
<span class="r-in"><span>  countryCodeISO3C <span class="op">=</span> <span class="st">"COD"</span>,</span></span>
<span class="r-in"><span>  incidenceData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Congo.EbolaIncidence</span>, n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="co">## Model options</span></span></span>
<span class="r-in"><span>  simulationIsDeterministic <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  dataAssimilationEnabled <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  healthZoneCoordinates <span class="op">=</span> <span class="va">healthZonesCongo</span>,</span></span>
<span class="r-in"><span>  variableCovarianceFunction <span class="op">=</span> <span class="st">"DBD"</span>,</span></span>
<span class="r-in"><span>  <span class="co">## Special parameters</span></span></span>
<span class="r-in"><span>  forecastError.cov.sdBackground <span class="op">=</span> <span class="fl">0.55</span>,</span></span>
<span class="r-in"><span>  forecastError.cor.length <span class="op">=</span> <span class="fl">6.75e-1</span>,</span></span>
<span class="r-in"><span>  neighbourhood.Bayes <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  psi.diagonal <span class="op">=</span> <span class="fl">1e-3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>[Linear interpolation operator] Raster aggregation factor is too high to differentiate between two (or more) health zones (they correspond to the same grid cell).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Cell [2]</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   `Health Zone`  Cell</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Katwa          <span style="text-decoration: underline;">3</span>415</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Vuhovi         <span style="text-decoration: underline;">3</span>415</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Mambasa        <span style="text-decoration: underline;">2</span>305</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Mandima        <span style="text-decoration: underline;">2</span>305</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in SVEIRD.BayesianDataAssimilation(alpha = 3.5e-05, beta = 0.007,     gamma = 1/7, sigma = 1/36, delta = 2/36, lambda = 18, n.days = simulation.days,     seedData = initialInfections.fourCities, neighbourhood.order = 1,     populationSpatRaster = populationDemocraticRepublicCongo,     aggregationFactor = rasterAggregationFactor, subregionsSpatVector = IturiNordKivu,     startDate = "2018-08-01", countryCodeISO3C = "COD", incidenceData = head(Congo.EbolaIncidence,         n = 4), simulationIsDeterministic = TRUE, dataAssimilationEnabled = TRUE,     healthZoneCoordinates = healthZonesCongo, variableCovarianceFunction = "DBD",     forecastError.cov.sdBackground = 0.55, forecastError.cor.length = 0.675,     neighbourhood.Bayes = 3, psi.diagonal = 0.001):</span> object 'radius' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bryce Carson, Ashok Krishnamurthy, Alberta Innovates.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

