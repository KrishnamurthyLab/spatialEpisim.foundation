<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian data assimilation — assimilateData • spatialEpisim.foundation</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian data assimilation — assimilateData"><meta name="description" content="Assimilation of data (Bayesian) using optimal statistical inference, a
modified Kalman Filter."><meta property="og:description" content="Assimilation of data (Bayesian) using optimal statistical inference, a
modified Kalman Filter."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">spatialEpisim.foundation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Getting_Started.html">Getting_Started</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ashokkrish/spatialEpisim-foundation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bayesian data assimilation</h1>
      <small class="dont-index">Source: <a href="https://github.com/ashokkrish/spatialEpisim-foundation/blob/main/R/SVEIRD.BayesianDataAssimilation.R" class="external-link"><code>R/SVEIRD.BayesianDataAssimilation.R</code></a></small>
      <div class="d-none name"><code>assimilateData.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Assimilation of data (Bayesian) using optimal statistical inference, a
modified Kalman Filter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assimilateData</span><span class="op">(</span></span>
<span>  <span class="va">layers</span>,</span>
<span>  <span class="va">linearInterpolationMatrix</span>,</span>
<span>  <span class="va">incidenceData</span>,</span>
<span>  <span class="va">healthZoneCoordinates</span>,</span>
<span>  <span class="va">psi.diagonal</span>,</span>
<span>  <span class="va">QHt</span>,</span>
<span>  <span class="va">HQHt</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-layers">layers<a class="anchor" aria-label="anchor" href="#arg-layers"></a></dt>
<dd><p>The SpatRaster object with layers Susceptible, Vaccinated,
Exposed, Infected, Recovered, and Dead.</p></dd>


<dt id="arg-linearinterpolationmatrix">linearInterpolationMatrix<a class="anchor" aria-label="anchor" href="#arg-linearinterpolationmatrix"></a></dt>
<dd><p>a linear forward interpolation operator
matrix with as many columns as cells in the SpatRaster layers, and as many
rows as health zones for which coordinates are provided (when creating a
matrix for use with one state vector). The matrix is either a trivial
matrix as described elsewhere (see <a href="linearInterpolationOperator.html">linearInterpolationOperator</a>), or two
partitions in a sparse, block diagonal matrix.</p></dd>


<dt id="arg-incidencedata">incidenceData<a class="anchor" aria-label="anchor" href="#arg-incidencedata"></a></dt>
<dd><p>A "situation report" dataframe. The first column
provides the date of the officially reported, observed incidence of the
disease, in ISO format (YYYY-MM-DD). MAYBE TODO: enforce the startDate
parameter to be one week prior to the first observed data?</p>
<div class="sourceCode"><pre><code>
    Date    Beni  Biena  Butembo  Goma  Kalunguta
    05-Aug  3     0      2        0     0
    12-Aug  2     0      0        0     0
    20-Aug  1     0      0        0     0
    26-Aug  5     0      0        0     0
    02-Sep  8     0      0        0     1
    09-Sep  5     0      2        0     0
    16-Sep  5     0      3        0     0
    23-Sep  4     0      1        0     0
    02-Oct  10    0      1        0     0
    07-Oct  14    0      4        0     0
    15-Oct  28    0      2        0     1
    21-Oct  19    0      3        0     0
    28-Oct  28    0      8        0     0
    04-Nov  16    0      6        0     1
    11-Nov  14    0      0        0     21
  </code></pre></div></dd>


<dt id="arg-healthzonecoordinates">healthZoneCoordinates<a class="anchor" aria-label="anchor" href="#arg-healthzonecoordinates"></a></dt>
<dd><p>a table of values giving the latitude and
longitude coordinates for health zones in the country of interest. See the
description of the healthZoneCoordinates argument in the function
SVEIRD.BayesianDataAssimilation for more details.</p>
<div class="sourceCode"><pre><code>
    HealthZone    Latitude    Longitude
    Alimbongo     -0.365515   29.1911818
    Beni          0.49113     29.47306
    Biena         0.57923     29.115633
    Butembo       0.140692    29.335014
    Goma          -1.658271   29.220132
    Kalunguta     0.323085    29.354677
    Katwa         0.116985    29.411838
    Kayna         -0.603936   29.174066
    Kyondo        -0.005622   29.408813
    Lubero        -0.15633    29.24057
    Mabalako      0.461257    29.210687
    Manguredjipa  0.353433    28.765479
    Masereka      -0.133333   29.333333
    Musienene     0.04022     29.26246
    Mutwanga      0.32893     29.74576
    Nyiragongo    -1.516667   29.25
    Oicha         0.698681    29.518834
    Pinga         -0.9830504  28.687911
    Vuhovi        0.1416      29.4075
    Ariwara       3.136873    30.706615
    Bunia         1.566667    30.25
    Komanda       1.367496    29.774322
    Lolwa         1.352969    29.498455
    Mambasa       1.359731    29.029226
    Mandima       1.35551     29.08173
    Nyakunde      1.431271    30.029283
    Rwampara      1.4053      30.3449
    Tchomia       1.4412      30.4845
  </code></pre></div></dd>


<dt id="arg-psi-diagonal">psi.diagonal<a class="anchor" aria-label="anchor" href="#arg-psi-diagonal"></a></dt>
<dd><p>A replacement value for elements of the Psi matrix'
diagonal which are zero.</p></dd>


<dt id="arg-qht">QHt<a class="anchor" aria-label="anchor" href="#arg-qht"></a></dt>
<dd><p>the <a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a> of the Q and H matrices.</p></dd>


<dt id="arg-hqht">HQHt<a class="anchor" aria-label="anchor" href="#arg-hqht"></a></dt>
<dd><p>the product of the H matrix and QHt.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list of SpatRasters, the Infected and Exposed SpatRasters</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Bryce Carson</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bryce Carson, Ashok Krishnamurthy, Alberta Innovates.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

